<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Item Details</title>
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>
  <main class="container">
    <div id="item-details">
      <!-- Item details will be loaded here -->
    </div>
    <a href="browse.html" class="btn">Back to Browse</a>
  </main>
  <script>
    // Use your deployed backend URL
    const API_BASE_URL = 'https://ecocart-backend-lcos.onrender.com/api/items'; 

    document.addEventListener('DOMContentLoaded', async () => {
      const params = new URLSearchParams(window.location.search);
      const id = params.get('id');
      const detailsContainer = document.getElementById('item-details');

      if (!id) {
        detailsContainer.innerHTML = '<p>Item not found.</p>';
        return;
      }

      try {
        const res = await fetch(API_BASE_URL);
        const data = await res.json();
        const items = data.data || data.items || [];

        const item = items.find(i => i._id === id);
        if (!item) {
          detailsContainer.innerHTML = '<p>Item not found.</p>';
          return;
        }

        detailsContainer.innerHTML = `
          <h2>${item.title}</h2>
          ${item.images && item.images.length > 0 
            ? `<img src="${item.images[0].url || (API_BASE_URL.replace('/api/items', '') + item.images[0].path)}" style="max-width:300px;">`
            : '<p>No image available</p>'}
          <p><strong>Description:</strong> ${item.description}</p>
          <p><strong>Category:</strong> ${item.category}</p>
          <p><strong>Condition:</strong> ${item.condition}</p>
          <p><strong>Location:</strong> ${item.location}</p>
        `;
      } catch (err) {
        console.error('Error fetching item details:', err);
        detailsContainer.innerHTML = '<p>Error loading item details.</p>';
      }
    });
  </script>
</body>
</html>
